plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: domaintools_phisheye
title: DomainTools PhishEye
description: Monitor the Internet for 'Phishy' Domains
version: 1.0.0
vendor: rapid7
support: community
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/domaintools_phisheye
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
tags:
- domaintools
- phisheye
hub_tags:
  use_cases: [data_enrichment, threat_detection_and_response]
  keywords: [domaintools, phisheye]
  features: []
connection:
  username:
    type: string
    description: Enter the API username
    required: true
  api_key:
    title: API Key
    type: credential_secret_key
    description: Enter the API key e.g. 11111-aaaaa-aaa11-111aa-aaa11
    required: true
types:
  ip_addresses:
    ip:
      title: IPv4
      description: IPv4 Address
      type: string
      required: true
    country_code:
      title: Country Code
      description: Country code
      type: string
      required: true
  domains:
    domain:
      title: Domain
      description: Links to WHOIS page for the domain
      type: string
      required: true
    tld:
      title: TLD
      description: TLD domain
      type: string
      required: true
    created_date:
      title: Created Date
      description: Date when domain created
      type: string
      required: false
    registrant_email:
      title: Registrant Email
      description: Email used for register
      type: string
      required: false
    ip_addresses:
      title: IP Addresses
      description: IPv4 Addresses
      type: "[]ip_addresses"
      required: false
    name_servers:
      title: Name Servers
      description: Name servers used by domain
      type: "[]string"
      required: false
    registrar_name:
      title: Registrar Name
      description: Registrar name where domain was registered
      type: string
      required: false
    risk_score:
      title: Risk Score
      description: Calculated by the Domain Risk Score
      type: integer
      required: false
actions:
  domain_list:
    title: Domain List
    description: Returns domain results for monitored terms
    input:
      query:
        title: Query
        type: string
        description: "Term for which the day's domains are desired"
        required: true
        example: rapid7
      days_back:
        title: Days Back
        type: integer
        description: "Use this parameter in exceptional circumstances where you need to find domains up to seven days prior to the current date. Set the value to an integer in the range of 1-7"
        required: false
        example: 1
    output:
      term:
        title: Term
        description: Query term
        type: string
        required: true
      date:
        title: Date
        description: Date when query run
        type: string
        required: false
      domains:
        title: Domains
        description: Domains for query
        type: "[]domains"
        required: true
