plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: rapid7_insightappsec
title: Rapid7 InsightAppSec
description: This plugin allows for the creation, configuration, and starting of scans. The plugin can also retrieve scan results and logging related to the execution of the scan
version: 3.0.0
vendor: rapid7
status: []
support: rapid7
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/rapid7_insightappsec
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.rapid7.com
tags:
- insightappsec
- Rapid7
hub_tags:
  use_cases: [devops, remediation_management, reporting_and_analytics, vulnerability_management]
  keywords: [insightappsec, rapid7]
  features: []
types:
  link:
    href:
      title: Href
      description: Href
      type: string
      required: false
    rel:
      title: Rel
      description: rel
      type: string
      required: false
  submitter:
    submitter_type:
      title: Type
      description: The type of the submitter e.g. USER
      type: string
      required: false
    id:
      title: ID
      description: The submitters UUID
      type: string
      required: false
  event_log:
    time:
      title: Time
      description: The time at which the log event occurred
      type: date
      required: false
    event:
      title: Event
      description: The log event
      type: string
      required: false
  scan_config:
    id:
      title: UUID
      description: The UUID of the scan configuration
      type: string
      required: false
    config_name:
      title: Name
      description: The name of the scan configuration
      type: string
      required: false
    config_description:
      title: Description
      description: The description of the scan configuration
      type: string
      required: false
    app_id:
      title: App ID
      description: App UUID
      type: string
      required: false
    attack_template_id:
      title: Attack Template ID
      description: Attack template UUID
      type: string
      required: false
    errors:
      title: Errors
      description: A list of errors that detail any current validation failures
      type: '[]string'
      required: false
    links:
      title: Links
      description: A list of links
      type: '[]link'
      required: false
  scan:
    id:
      title: ID
      description: Scan UUID
      type: string
      required: false
    app_id:
      title: App ID
      description: App UUID
      type: string
      required: false
    scan_config_id:
      title: Scan Config ID
      description: Scan configs UUID
      type: string
      required: false
    submitter:
      title: Submitter
      description: The submitter of the scan
      type: submitter
      required: false
    submit_time:
      title: Submit Time
      description: The time the scan was submitted
      type: date
      required: false
    completion_time:
      title: Completion Time
      description: The time the scan was completed
      type: date
      required: false
    status:
      title: Status
      description: The status of the scan
      type: string
      required: false
    failure_reason:
      title: Failure Reason
      description: The reason the scan may have failed
      type: string
      required: false
    links:
      title: Links
      description: A list of links
      type: '[]link'
      required: false
  scan_details:
    logged_in:
      title: Logged-In
      description: A flag which indicates if the scan is using authentication during the scan
      type: boolean
      required: false
    links_in_queue:
      title: Links in Queue
      description: The number of links in the crawling queue
      type: integer
      required: false
    links_crawled:
      title: Links Crawled
      description: The number of links already crawled
      type: integer
      required: false
    attacks_in_queue:
      title: Attacks in Queue
      description: The number of links in the attacking queue
      type: integer
      required: false
    attacked:
      title: Attacked
      description: The number of attacks already performed
      type: integer
      required: false
    vulnerable:
      title: Vulnerable
      description: The number of potential findings
      type: integer
      required: false
    requests:
      title: Requests
      description: The number of HTTP requests which have been executed
      type: integer
      required: false
    failed_requests:
      title: Failed Requests
      description: The number of failed HTTP requests
      type: integer
      required: false
    network_speed:
      title: Network Speed
      description: A throughput indicator
      type: number
      required: false
    drip_delay:
      title: Drip Delay
      description: The current delay between HTTP requests
      type: number
      required: false
  frequency:
    type:
      title:
      description:
      type: string
      required: false
    interval:
      title:
      description:
      type: integer
      required: false
  schedule:
    id:
      title: Assigned UUID of Schedule
      description:
      type: string
      required: false
    name:
      title: Name of Schedule
      description:
      type: string
      required: false
    enabled:
      title: Enable the schedule
      description:
      type: boolean
      required: false
    first_start:
      title: Date String for the start of the schedule
      description: A date string used to start a schedule
      type: string
      required: false
  app:
    app_id:
      title: Application ID
      description: Application UUID
      type: string
      required: false
    app_name:
      title: Application Name
      description: The name of the application
      type: string
      required: false
    app_description:
      title: Application Description
      description: Describe the application
      type: string
      required: false
    app_links:
      title: Links
      description: A list of links
      type: '[]link'
      required: false
  uuid:
    id:
      title: An ID string
      description: A string to identify a user, application, scan, engine, blackout
      type: string
      required: false
  target:
    url:
      title: URL
      description: URL to define an application
      type: string
      required: false
connection:
  api_key:
    title: API Key
    description: The API key for InsightAppSec
    type: credential_secret_key
    required: true
    example: abc12345-abc1-2345-abc1-abc123456789
  url:
    title: URL
    description: The region specific URL endpoint for InsightAppSec
    type: string
    required: true
    default: https://us.api.insight.rapid7.com
    example: https://us.api.insight.rapid7.com
actions:
  get_apps:
    title: Get All Apps
    description: Get a page of all apps
    input:
      sort:
        title: Sort
        description: How to sort the response
        type: string
        required: false
        default: "ASC"
        example: "ASC"
      index:
        title: Index
        description: The page number of the return data set
        type: integer
        required: false
        default: 0
        example: 0
      size:
        title: Size
        description: The data set size or the max number of apps to return per page
        type: integer
        required: false
        default: 100
        example: 100
    output:
      metadata:
        title: Metadata
        description: Metadata for the app results
        type: object
        required: false
      data:
        title: App Data
        description: App data
        type: '[]app'
        required: false
      links:
        title: Links to Data
        description: Links to data
        type: '[]link'
        required: false
  create_app:
    title: Create App
    description: Create a new app asset
    input:
      app_name:
        title: Application Name
        description: The name of the application
        type: string
        required: true
        example: "Name Of the APP"
      app_description:
        title: Application Description
        description: Describe the application
        type: string
        required: false
        example: "An optional description"
    output:
      app_id:
        title: Application ID
        description: Application UUID
        type: string
        required: true
  get_app:
    title: Get One App
    description: Get limited details about an existing App
    input:
      app_id:
        title: Application ID
        description: Application UUID
        type: 'uuid'
        required: true
        example: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx"
    output:
      app_id:
        title: Application ID
        description: Application UUID
        type: string
        required: false
      app_name:
        title: Application Name
        description: The name of the application
        type: string
        required: false
      app_description:
        title: Application Description
        description: Describe the application
        type: string
        required: false
      links:
        title: Links
        description: A list of links
        type: '[]link'
        required: false
  delete_app:
    title: Delete Application
    description: De;ete an existing application
    input:
      app_id:
        title: Application ID
        description: Application UUID
        type: string
        required: true
        example: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
    output:
      status:
        title: Status
        description: Status code of the request
        type: integer
        required: false
  update_app:
    title: Update an Existing Application
    description: Update the name or description of an existing Application
    input:
      app_id:
        title: Application ID
        description: Application UUID
        type: string
        required: true
        example: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
      app_name:
        title: Application Name
        description: The name of an application
        type: string
        required: true
      app_description:
        title: Application Description
        description: Describe the application
        type: string
        required: false
    output:
      status:
        title: Status
        description: Status code of the request
        type: integer
        required: false
  get_app_users:
    title: Get Users Associated with an Application
    description: A list of users with access to an application
    input:
      app_id:
        title: Application ID
        description: Application UUID
        type: string
        required: true
        example: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
    output:
      user_id:
        title: Application User
        description: A list of users UUID
        type: '[]uuid'
        required: false
  add_app_user:
    title: Associate a User to an Application
    description: Add a user for access to an application
    input:
      app_id:
        title: Application ID
        description: Application UUID
        type: 'uuid'
        required: true
        example: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
      user_id:
        title: User ID
        description: User UUID
        type: 'uuid'
        required: true
        example: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
    output:
      status:
        title: Status
        description: Status code of the request
        type: integer
        required: false
  remove_app_user:
    title: Dissociate a User from an Application
    description: Remove a user from accessing an application
    input:
      app_id:
        title: Application ID
        description: Application UUID
        type: 'uuid'
        required: true
        example: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
      user_id:
        title: User ID
        description: User UUID
        type: 'uuid'
        required: true
        example: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
    output:
      status:
        title: Status
        description: Status code of the request
        type: integer
        required: false
  create_scan_config:
    title: Create Scan Config
    description: Create a new scan configuration
    input:
      config_name:
        title: Name
        description: The name of the scan configuration
        type: string
        required: true
        example: "Scan Config 1"
      config_description:
        title: Description
        description: The description of the scan configuration
        type: string
        required: false
        example: "Description for scan config"
      app_id:
        title: App ID
        description: App UUID
        type: string
        required: true
        example: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
      attack_template_id:
        title: Attack Template ID
        description: Attack template UUID
        type: string
        required: true
        example: "11111111-0000-0000-0000-000000000000"
      assignment_environment:
        title: Assignment Environment
        description: Where the scan will run from ON_PREMISE or CLOUD
        required: true
        type: string
        enum:
        - CLOUD
        - ON_PREMISE
        example: CLOUD
        default: CLOUD
      assignment_id:
        title: Engine Group UUID
        description: The UUID of the engine Group
        required: true
        type: string
        example: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
      assignment_type:
        title: Assignment Type
        description: The type of engine assignment
        required: true
        type: string
        example: ENGINE_GROUP
        default: ENGINE_GROUP
    output:
      scan_config_id:
        title: Application ID
        description: Application UUID
        type: string
        required: false
  get_scan_config:
    title: Get Scan Config
    description: Get a scan configuration
    input:
      scan_config_id:
        title: Scan Config ID
        description: Scan configuration UUID
        type: string
        required: true
        example: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx"
    output:
      id:
        title: UUID
        description: The UUID of the scan configuration
        type: string
        required: false
      config_name:
        title: Name
        description: The name of the scan configuration
        type: string
        required: false
      config_description:
        title: Description
        description: The description of the scan configuration
        type: string
        required: false
      app_id:
        title: App ID
        description: App UUID
        type: string
        required: false
      attack_template_id:
        title: Attack Template ID
        description: Attack template UUID
        type: string
        required: false
      assignment_environment:
        title: Scan Engine Environment
        description: Where the scan engine runs, cloud or on-premise
        type: string
        required: false
      assignment_id:
        title: Assignment ID
        description: UUID of the engine group assignment
        type: string
        required: false
      assignment_type:
        title: Type of Assignment
        description: A static string
        type: string
        required: false
      errors:
        title: Errors
        description: A list of errors that detail any current validation failures
        type: '[]string'
        required: false
      links:
        title: Links
        description: A list of links
        type: '[]link'
        required: false
  update_scan_config:
    title: Update Scan Config
    description: Update an existing scan configuration
    input:
      scan_config_id:
        title: Scan Config ID
        description: Scan configuration UUID
        type: string
        required: true
        example: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
      config_name:
        title: Name
        description: The name of the scan configuration
        type: string
        required: true
        example: "Scan Config 1"
      config_description:
        title: Description
        description: The description of the scan configuration
        type: string
        required: false
        example: "Description of scan config"
      app_id:
        title: App ID
        description: App UUID
        type: string
        required: true
        example: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx"
      attack_template_id:
        title: Attack Template ID
        description: Attack template UUID
        type: string
        required: true
        example: "11111111-0000-0000-0000-000000000000"
      assignment_environment:
        title: Assignment Environment
        description: Where the scan will run from ON_PREMISE or CLOUD
        required: false
        type: string
        enum:
        - CLOUD
        - ON_PREMISE
        example: CLOUD
        default: CLOUD
      assignment_id:
        title: Engine Group UUID
        description: The UUID of the engine Group
        required: false
        type: string
        example: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
      assignment_type:
        title: Assignment Type
        description: The type of engine assignment
        required: false
        type: string
        example: ENGINE_GROUP
        default: ENGINE_GROUP
    output:
      status:
        title: Status
        description: Status code of the request
        type: integer
        required: false
  delete_scan_config:
    title: Delete Scan Config
    description: Delete an existing scan configuration
    input:
      scan_config_id:
        title: Scan Config ID
        description: Scan configuration UUID
        type: string
        required: true
        example: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx"
    output:
      status:
        title: Status
        description: Status code of the request
        type: integer
        required: false
  get_scan_configs:
    title: Get Scan Configs
    description: Get a page of scan configurations, based on supplied pagination parameters
    input:
      sort:
        title: Sort
        description: How to sort the response
        type: string
        required: false
        default: "ASC"
        example: "scanconfig.name,DESC"
      index:
        title: Index
        description: The page number of the return data set
        type: integer
        required: false
        default: 0
        example: 0
      size:
        title: Size
        description: The data set size or the max number of apps to return per page
        type: integer
        required: false
        default: 100
        example: 100
      include-errors:
        title: Validation Errors
        description: Iclude validation errors in scan configs, can be expensive
        type: boolean
        required: false
        default: true
        example: false
    output:
      metadata:
        title: Metadata
        description: Metadata for the scan results
        type: object
        required: false
      data:
        title: Scan Configs
        description: A list of scan configurations
        type: '[]scan_config'
        required: false
      links:
        title: Links to Data
        description: Links to data
        type: '[]link'
        required: false
  submit_scan:
    title: Submit Scan
    description: Submit a new scan
    input:
      scan_config_id:
        title: Scan Config ID
        description: UUID of the scan config to use
        type: 'uuid'
        required: true
        example: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
    output:
      scan_id:
        title: Scan ID
        description: Scan UUID
        type: string
        required: true
  get_scan:
    title: Get Scan
    description: Get a scan
    input:
      scan_id:
        title: Scan ID
        description: The scans UUID
        type: string
        required: true
        example: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx"
    output:
      scan:
        title: Scan
        description: Information on the scan
        type: scan
        required: false
  get_scans:
    title: Get Scans
    description: Get a page of scans, based on supplied pagination parameters
    input:
      index:
        title: Index
        description: The page index to start form. If blank, index will be 0
        type: integer
        required: false
        example: 0
      size:
        title: Size
        description: The number of entries on each page. If blank, size will be 50
        type: integer
        required: false
        example: 50
      sort:
        title: Sort
        description: How to sort the scans. If blank, sort will be alphabetical by
          scan name
        type: string
        required: false
        example: "scan.submit_time,DESC"
    output:
      metadata:
        title: Metadata
        description: Metadata for the scan results
        type: object
        required: false
      data:
        title: Scans
        description: A list of scans
        type: '[]scan'
        required: false
      links:
        title: Links to Data
        description: Links to data
        type: '[]link'
        required: false
  delete_scan:
    title: Delete Scan
    description: Delete a scan
    input:
      scan_id:
        title: Scan ID
        description: The scans UUID
        type: 'uuid'
        required: true
        example: "xxxxxxxx-xxxx-xxxx-xxxxxxxxxxxx"
    output:
      status:
        title: Status
        description: Status code of the request
        type: integer
        required: false
  submit_scan_action:
    title: Submit Scan Action
    description: Submit a new scan action
    input:
      scan_id:
        title: Scan ID
        description: Scan UUID
        type: 'uuid'
        required: true
        example: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
      action:
        title: Action
        description: Action to take
        type: string
        required: true
        default: Pause
        enum:
        - Pause
        - Resume
        - Stop
        - Cancel
        - Authenticate
        example: "Pause"
    output:
      status:
        title: Status
        description: Status code of the request
        type: integer
        required: false
  get_scan_engine_events:
    title: Get Scan Engine Events
    description: Get the engine events from a scan
    input:
      scan_id:
        title: Scan ID
        description: Scan UUID
        type: string
        required: true
        example: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx"
    output:
      events:
        title: Events
        description: An array of event logs and their dates
        type: '[]event_log'
        required: false
  get_scan_execution_details:
    title: Get Scan Execution Details
    description: Get real-time details of the execution of a scan
    input:
      scan_id:
        title: Scan ID
        description: Scan UUID
        type: string
        required: true
        example: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx"
    output:
      details:
        title: Details
        description: Detailed information about the scan
        type: scan_details
        required: false
  get_scan_platform_events:
    title: Get Scan Platform Events
    description: Get the platform events from a scan
    input:
      scan_id:
        title: Scan ID
        description: Scan UUID
        type: string
        required: true
        example: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx"
    output:
      events:
        title: Events
        description: An array of event logs and their dates
        type: '[]event_log'
        required: false
  get_schedules:
    title: Get All Schedules
    description: Get a page of Schedules
    input:
      sort:
        title: Sort
        description: How to sort the response
        type: string
        required: false
        example: "ASC"
      index:
        title: Index
        description: The page number of the return data set
        type: integer
        required: false
        default: 0
        example: 0
      size:
        title: Size
        description: The data set size or the max number of apps to return per page
        type: integer
        required: false
        default: 100
        example: 100
    output:
      metadata:
        title: Metadata
        description: Metadata for the scedules
        type: object
        required: false
      data:
        title: Response Data
        description: Response data
        type: '[]schedule'
        required: false
      links:
        title: Links to Data
        description: Links to data
        type: '[]link'
        required: false
